â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Network Load Balancer for Panic Button TCP Servers        â•‘
â•‘                                                              â•‘
â•‘  This is CRITICAL for panic button reliability!             â•‘
â•‘  Creates high-availability TCP load balancing               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ What this creates:
  - Network Load Balancer (Layer 4)
  - Target Groups for ports 4000-4009
  - Health checks for each TCP port
  - Static IP addresses for panic buttons
  - Automatic failover capability


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 1: Creating Network Load Balancer
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Elastic IPs allocated:
   EIP 1: eipalloc-044fd849918217b36
   EIP 2: eipalloc-0d03c3402fa11145a
   Public IPs: 16.28.37.255, 13.246.81.110
âœ… Network Load Balancer Created
   ARN: arn:aws:elasticloadbalancing:af-south-1:877582899699:loadbalancer/net/mysos-titan-nlb-tcp/5fc7b76fa947682e
   DNS: mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 2: Creating Target Groups for TCP Ports
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Target Group Created: Port 4000 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4000/802ce4534dbe73b7)
   âœ… Registered instance i-04b97d4d49468a701:4000
âœ… Target Group Created: Port 4001 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4001/699dd3b297dfb2d7)
   âœ… Registered instance i-04b97d4d49468a701:4001
âœ… Target Group Created: Port 4002 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4002/20f68e5278655bd9)
   âœ… Registered instance i-04b97d4d49468a701:4002
âœ… Target Group Created: Port 4003 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4003/f616c858577c3bf1)
   âœ… Registered instance i-04b97d4d49468a701:4003
âœ… Target Group Created: Port 4004 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4004/c0d6a19bb967050b)
   âœ… Registered instance i-04b97d4d49468a701:4004
âœ… Target Group Created: Port 4005 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4005/6ef90a0c6c57a9e8)
   âœ… Registered instance i-04b97d4d49468a701:4005
âœ… Target Group Created: Port 4006 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4006/8476e86dd079b6b2)
   âœ… Registered instance i-04b97d4d49468a701:4006
âœ… Target Group Created: Port 4007 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4007/0a31beef1b390a30)
   âœ… Registered instance i-04b97d4d49468a701:4007
âœ… Target Group Created: Port 4008 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4008/428305db621c8176)
   âœ… Registered instance i-04b97d4d49468a701:4008
âœ… Target Group Created: Port 4009 (arn:aws:elasticloadbalancing:af-south-1:877582899699:targetgroup/mysos-titan-tcp-4009/f9b2bd49c46573f8)
   âœ… Registered instance i-04b97d4d49468a701:4009

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 3: Creating Listeners for Each Port
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Listener Created: Port 4000 â†’ Target Group
âœ… Listener Created: Port 4001 â†’ Target Group
âœ… Listener Created: Port 4002 â†’ Target Group
âœ… Listener Created: Port 4003 â†’ Target Group
âœ… Listener Created: Port 4004 â†’ Target Group
âœ… Listener Created: Port 4005 â†’ Target Group
âœ… Listener Created: Port 4006 â†’ Target Group
âœ… Listener Created: Port 4007 â†’ Target Group
âœ… Listener Created: Port 4008 â†’ Target Group
âœ… Listener Created: Port 4009 â†’ Target Group

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 4: Updating Security Group
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â³ Updating Node.js security group to allow NLB traffic...
{
    "Return": true,
    "SecurityGroupRules": [
        {
            "SecurityGroupRuleId": "sgr-018eea85a19ddb4dd",
            "GroupId": "sg-0115fa6aaf818f87d",
            "GroupOwnerId": "877582899699",
            "IsEgress": false,
            "IpProtocol": "tcp",
            "FromPort": 4000,
            "ToPort": 4009,
            "CidrIpv4": "10.0.0.0/16",
            "SecurityGroupRuleArn": "arn:aws:ec2:af-south-1:877582899699:security-group-rule/sgr-018eea85a19ddb4dd"
        }
    ]
}
âœ… Security group updated

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 5: Waiting for Target Health Checks
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â³ Waiting for targets to become healthy (this takes 1-2 minutes)...

Checking target health:
  âš ï¸  Port 4000: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4001: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4002: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4003: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4004: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4005: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4006: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4007: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4008: initial (may need more time or check PM2 on server)
  âš ï¸  Port 4009: initial (may need more time or check PM2 on server)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           ğŸ‰ Network Load Balancer Setup Complete! ğŸ‰        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ Network Load Balancer Details
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

DNS Name: mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com
Static IPs:
  - 16.28.37.255 (AZ 1)
  - 13.246.81.110 (AZ 2)

Listening on ports: 4000-4009

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ IMPORTANT: Update Panic Button Configuration
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Update all panic buttons to connect to NLB instead of EC2:

OLD: panic-button-1 connects to 13.245.88.195:4000
NEW: panic-button-1 connects to 16.28.37.255:4000

Or use DNS (recommended):
NEW: panic-button-1 connects to mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4000

Port mapping:
  panic-button-1 â†’ 16.28.37.255:4000 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4000
  panic-button-2 â†’ 16.28.37.255:4001 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4001
  panic-button-3 â†’ 16.28.37.255:4002 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4002
  panic-button-4 â†’ 16.28.37.255:4003 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4003
  panic-button-5 â†’ 16.28.37.255:4004 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4004
  panic-button-6 â†’ 16.28.37.255:4005 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4005
  panic-button-7 â†’ 16.28.37.255:4006 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4006
  panic-button-8 â†’ 16.28.37.255:4007 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4007
  panic-button-9 â†’ 16.28.37.255:4008 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4008
  panic-button-10 â†’ 16.28.37.255:4009 or mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com:4009

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” Testing Connection
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Test TCP connection to NLB:
  nc -zv mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com 4000

Or from panic button, test connection:
  telnet 16.28.37.255 4000

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š Benefits Achieved
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… High availability - automatic failover
âœ… Health checks - unhealthy targets removed
âœ… Static IP addresses - easier panic button config
âœ… Can now scale Node.js horizontally
âœ… Zero-downtime deployments possible
âœ… Better security - can restrict EC2 SSH

ğŸ’° Cost: ~6/month

ğŸ¯ Next Steps:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Test each port: for i in {4000..4009}; do nc -zv mysos-titan-nlb-tcp-5fc7b76fa947682e.elb.af-south-1.amazonaws.com $i; done
2. Update panic button firmware/config to use new IPs
3. Monitor CloudWatch for connection metrics
4. Consider adding second Node.js instance for true HA
5. Update documentation with new connection endpoints

ğŸ“ˆ To add more Node.js instances:
  1. Launch new EC2 with same setup
  2. Register with target groups:
     aws elbv2 register-targets --target-group-arn <TG_ARN> --targets Id=<NEW_INSTANCE_ID>
  3. NLB automatically distributes traffic

